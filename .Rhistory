if(color.var=="none"){
if(levels(factor(z$order))>1 & "site"%in%names(z)){
warning("invalid color.var setting, the iNEXT object consists multiple sites and orders, change setting as both")
color.var <- "both"
z$col <- z$shape <- paste(z$site, z$order, sep="-")
}else if("site"%in%names(z)){
warning("invalid color.var setting, the iNEXT object consists multiple orders, change setting as order")
color.var <- "site"
z$col <- z$shape <- z$site
}else if(levels(factor(z$order))>1){
warning("invalid color.var setting, the iNEXT object consists multiple sites, change setting as site")
color.var <- "order"
z$col <- z$shape <- factor(z$order)
}else{
z$col <- z$shape <- rep(1, nrow(z))
}
}else if(color.var=="order"){
z$col <- z$shape <- factor(z$order)
}else if(color.var=="site"){
if(!"site"%in%names(z)){
warning("invalid color.var setting, the iNEXT object do not consist multiple sites, change setting as order")
z$col <- z$shape <- factor(z$order)
}
z$col <- z$shape <- z$site
}else if(color.var=="both"){
if(!"site"%in%names(z)){
warning("invalid color.var setting, the iNEXT object do not consist multiple sites, change setting as order")
z$col <- z$shape <- factor(z$order)
}
z$col <- z$shape <- paste(z$site, z$order, sep="-")
}
g <- ggplot(z, aes(x=x, y=y, colour=factor(col))) +
geom_point(aes(shape=shape), size=5, data=subset(z, method=="observed"))
g <- g + geom_line(aes(linetype=factor(method, c("interpolated", "extrapolated"), c("interpolation", "extrapolation"))), size=1.5) +
guides(linetype=guide_legend(title="Method"),
colour=guide_legend(title="Guides"),
fill=guide_legend(title="Guides"),
shape=guide_legend(title="Guides")) +
theme(legend.position = "bottom",
legend.title=element_blank(),
text=element_text(size=18))
if(type==2L) {
g <- g + labs(x="Number of sampling units", y="Sample coverage")
if(names(x$DataInfo)[1]=="n") g <- g + labs(x="Number of individuals", y="Sample coverage")
}
else if(type==3L) {
g <- g + labs(x="Sample coverage", y="Species diversity")
}
else {
g <- g + labs(x="Number of sampling units", y="Species diversity")
if(names(x$DataInfo)[1]=="n") g <- g + labs(x="Number of individuals", y="Species diversity")
}
if(se)
g <- g + geom_ribbon(aes(ymin=y.lwr, ymax=y.upr, fill=factor(col), colour=NULL), alpha=0.2)
if(facet.var=="order"){
if(length(levels(factor(z$order))) == 1 & type!=2){
warning("invalid facet.var setting, the iNEXT object do not consist multiple orders.")
}else{
g <- g + facet_wrap(~order, nrow=1)
if(color.var=="both"){
g <- g + guides(colour=guide_legend(title="Guides", ncol=length(levels(factor(z$order))), byrow=TRUE),
fill=guide_legend(title="Guides"))
}
}
}
if(facet.var=="site"){
if(!"site"%in%names(z)) {
warning("invalid facet.var setting, the iNEXT object do not consist multiple sites.")
}else{
g <- g + facet_wrap(~site, nrow=1)
if(color.var=="both"){
g <- g + guides(colour=guide_legend(title="Guides", nrow=length(levels(factor(z$order)))),
fill=guide_legend(title="Guides"))
}
}
}
if(facet.var=="both"){
if(length(levels(factor(z$order))) == 1 | !"site"%in%names(z)){
warning("invalid facet.var setting, the iNEXT object do not consist multiple sites or orders.")
}else{
g <- g + facet_wrap(site~order)
if(color.var=="both"){
g <- g +  guides(colour=guide_legend(title="Guides", nrow=length(levels(factor(z$site))), byrow=TRUE),
fill=guide_legend(title="Guides"))
}
}
}
if(grey){
g <- g + theme_bw(base_size = 18) +
scale_fill_grey(start = 0, end = .4) +
scale_colour_grey(start = .2, end = .2) +
guides(linetype=guide_legend(title="Method"),
colour=guide_legend(title="Guides"),
fill=guide_legend(title="Guides"),
shape=guide_legend(title="Guides")) +
theme(legend.position="bottom",
legend.title=element_blank())
}
return(g)
}
ggiNEXT(out)
ggiNEXT(out1)
g=ggiNEXT(out1)
g$data
str(g$data)
g$layers[[fortify.iNEXT]]
g$layers
plot(1:10)
plot(1:10, din=10)
plot(1:10, cxy=10)
plot(1:10, cxy=1)
plot(1:10, cra=1)
plot(1:10, cra=1/20)
warnings()
g$layers
g$layers[[1]]$aes_params
g$layers[[2]]$aes_params$size
g$layers[[2]]
g$layers[[3]]
g$layers[[3]]$aes_params
g$layers[[1]]$super
g$theme
g$layers[[1]]
g$plot_env
g$theme$legend.position
g$theme$legend.title
g$mapping
g$coordinates
g$labels
plot.iNEXT(out)
plot(out)
source('~/github/iNEXT/R/plot.R')
plot(out)
library(iNEXT)
?iNEXT
method
vignette(package="iNEXT")
library(iNEXT)
vignette(package="iNEXT")
build_vignettes()
vignette(package="iNEXT")
library(iNEXT)
vignette("Introduction-by-Examples", package="iNEXT")
?plot
out
print.listof
print.lm
print.table()
print.table
?print.anova.lm
x
x <- out
x$DataInfo
x$AsyEst
library(ape4)
library(ade4)
?ade4
data(humDNAm)
amovahum <- amova(humDNAm$samples, sqrt(humDNAm$distances), humDNAm$structures)
amovahum
amova()
amova
print.amova
data(meaudret)
pca1 <- dudi.pca(meaudret$env, scan = FALSE, nf = 4)
pca1
dudi.pca
library(stat)
?lm
library(stats)
print.listof
ctl <- c(4.17,5.58,5.18,6.11,4.50,4.61,5.17,4.53,5.33,5.14)
trt <- c(4.81,4.17,4.41,3.59,5.87,3.83,6.03,4.89,4.32,4.69)
group <- gl(2, 10, 20, labels = c("Ctl","Trt"))
weight <- c(ctl, trt)
lm.D9 <- lm(weight ~ group)
lm.D9
class(lm.D9)
t.test
print.aov
out
?ape4
?ade4
print.nipals
print.phylog
out$DataInfo
out$AsyEst
?print.plot
?print.phylog
marthans.tre <- NULL
marthans.tre[1] <-"((((1:4,2:4)a:5,(3:7,4:7)b:2)c:2,5:11)d:2,"
marthans.tre[2] <- "((6:5,7:5)e:4,(8:4,9:4)f:5)g:4);"
marthans.phylog <- newick2phylog(marthans.tre)
marthans.phylog
x$iNextEst[[1]]$order
site.n <- nrow(x$DataInfo)
order.n <- unique(x$iNextEst[[1]]$order)
cat("Compare",site.n,"assemblages with Hill number order q =",order.n,"\n")
cat("Compare",site.n,"assemblages with Hill number order q =",order.n,"\n", sep = ", ")
cat("Compare",site.n,"assemblages with Hill number order q = ")
cat(order.n,"\n", sep = ",")
order.n <- paste(unique(x$iNextEst[[1]]$order), sep=",")
cat("Compare",site.n,"assemblages with Hill number order q = ",cat(order.n,"\n", sep = ",")
cat("Compare",site.n,"assemblages with Hill number order q = ", order.n,"\n", sep = ",")
cat("Compare",site.n,"assemblages with Hill number order q = ", order.n,"\n")
order.n <- paste(unique(x$iNextEst[[1]]$order), sep=",")
cat("Compare",site.n,"assemblages with Hill number order q = ", order.n,"\n")
order.n
order.n <- sprintf("%s", unique(x$iNextEst[[1]]$order))
order.n
order.n[2]
order.n <- cat(unique(x$iNextEst[[1]]$order), sep=",")
order.n <- cat(unique(x$iNextEst[[1]]$order), sep=", ")
cat("Compare",site.n,"assemblages with Hill number order q = ", order.n,"\n")
?cat
cat(paste(letters, 100* 1:26), fill = TRUE, labels = paste0("{", 1:10, "}:"))
print("Compare",site.n,"assemblages with Hill number order q = ", order.n,"\n")
site.n <- nrow(x$DataInfo)
order.n <- cat(unique(x$iNextEst[[1]]$order), sep=", ")
order.n <- unique(x$iNextEst[[1]]$order)
order.n
order.n <- cat(unique(x$iNextEst[[1]]$order), sep=", ")
sprintf("q = %s", order.n)
order.n <- cat(unique(x$iNextEst[[1]]$order), sep=", ")
sprintf("q = %s", order.n)
sprintf("q = %s", site.n)
class(order.n)
mode(order.n)
order.n <- as.character(cat(unique(x$iNextEst[[1]]$order), sep=", "))
order.n
do.call(past0, c(0,1,2))
order.n <- paste(unique(x$iNextEst[[1]]$order), sep=", ", collapse = "")
order.n
order.n <- paste(unique(x$iNextEst[[1]]$order), collapse = ", ")
sprintf("q = %s", site.n)
sprintf("q = %s", order.n)
cat("Compare", site.n, "assemblages with Hill number order q = ", order.n,"\n")
site.n <- nrow(x$DataInfo)
order.n <- paste(unique(x$iNextEst[[1]]$order), collapse = ", ")
cat("Compare", site.n, "assemblages with Hill number order q =", order.n,".\n")
summary(x)
marthans.tre <- NULL
marthans.tre[1] <-"((((1:4,2:4)a:5,(3:7,4:7)b:2)c:2,5:11)d:2,"
marthans.tre[2] <- "((6:5,7:5)e:4,(8:4,9:4)f:5)g:4);"
marthans.phylog <- newick2phylog(marthans.tre)
marthans.phylog
vignette("iNEXT")
vignette(pack="iNEXT")
vignette("Introduction-by-Examples",pack="iNEXT")
print.iNEXT <- function(x){
site.n <- nrow(x$DataInfo)
order.n <- paste(unique(x$iNextEst[[1]]$order), collapse = ", ")
cat("Compare", site.n, "assemblages with Hill number order q =", order.n,".\n")
cat("$class: iNEXT\n")
cat("$DataInfo: basic data information\n")
cat("$iNextEst: showing diversity estimates along with related statistics for a series of rarefied and extrapolated samples.\n")
cat("$AsyEst: showing asymptotic diversity estimates along with related statistics.\n")
return(x)
}
out
print.iNEXT <- function(x){
site.n <- nrow(x$DataInfo)
order.n <- paste(unique(x$iNextEst[[1]]$order), collapse = ", ")
cat("Compare ", site.n, " assemblages with Hill number order q = ", order.n,".\n", sep="")
cat("$class: iNEXT\n")
cat("$DataInfo: basic data information\n")
cat("$iNextEst: showing diversity estimates along with related statistics for a series of rarefied and extrapolated samples.\n")
cat("$AsyEst: showing asymptotic diversity estimates along with related statistics.\n")
return(x)
}
print.iNEXT(x)
x
print.iNEXT <- function(x){
site.n <- nrow(x$DataInfo)
order.n <- paste(unique(x$iNextEst[[1]]$order), collapse = ", ")
cat("Compare ", site.n, " assemblages with Hill number order q = ", order.n,".\n", sep="")
cat("$class: iNEXT\n")
cat("$DataInfo: basic data information\n")
cat("$iNextEst: showing diversity estimates along with related statistics for a series of rarefied and extrapolated samples.\n")
cat("$AsyEst: showing asymptotic diversity estimates along with related statistics.\n")
print(x$DataInfo)
}
x
print.iNEXT <- function(x){
site.n <- nrow(x$DataInfo)
order.n <- paste(unique(x$iNextEst[[1]]$order), collapse = ", ")
cat("Compare ", site.n, " assemblages with Hill number order q = ", order.n,".\n", sep="")
cat("$class: iNEXT\n")
cat("$DataInfo: basic data information\n")
cat("$iNextEst: showing diversity estimates along with related statistics for a series of rarefied and extrapolated samples.\n")
cat("$AsyEst: showing asymptotic diversity estimates along with related statistics.\n")
cat("=== output")
print(x$DataInfo)
print(x$iNextEst)
print(x$AsyEst)
}
print(x)
print.iNEXT <- function(x){
site.n <- nrow(x$DataInfo)
order.n <- paste(unique(x$iNextEst[[1]]$order), collapse = ", ")
cat("Compare ", site.n, " assemblages with Hill number order q = ", order.n,".\n", sep="")
cat("$class: iNEXT\n")
cat("$DataInfo: basic data information\n")
cat("$iNextEst: showing diversity estimates along with related statistics for a series of rarefied and extrapolated samples.\n")
cat("$AsyEst: showing asymptotic diversity estimates along with related statistics.\n")
print(x)
}
print.iNEXT(x)
rm(print.iNEXT())
rm(print.iNEXT)
x
print.iNEXT <- function(x){
site.n <- nrow(x$DataInfo)
order.n <- paste(unique(x$iNextEst[[1]]$order), collapse = ", ")
cat("Compare ", site.n, " assemblages with Hill number order q = ", order.n,".\n", sep="")
cat("$class: iNEXT\n")
cat("$DataInfo: basic data information\n")
cat("$iNextEst: showing diversity estimates along with related statistics for a series of rarefied and extrapolated samples.\n")
cat("$AsyEst: showing asymptotic diversity estimates along with related statistics.\n")
return(invisible())
}
print.iNEXT(x)
library(iNEXT)
?iNEXT
data(spider)
out =iNEXT(spider, q=0, datatype="abundance")
out
out$DataInfo
library(iNEXT)
out$DataInfo
data(spider)
out =iNEXT(spider, q=0, datatype="abundance")
out$DataInfo
x
data(spider)
out <- iNEXT(spider, q=0, datatype="abundance")
out$DataInfo
names(out$DataInfo)[1]
x <- spider$Girdled
out <- iNEXT(x, q=0, datatype="abundance")
x
iNEXT(x, q=0, datatype="abundance")
x <- spider$Girdled
out <- iNEXT(x, q=0, datatype="abundance")
x
library(iNEXT)
d
x <- spider$Girdled
out <- iNEXT(x, q=0, datatype="abundance")
out
x$iNextEst
out$iNextEst
library(iNEXT)
data(spider)
out <- iNEXT(spider, q=0, datatype="abundance")
fortify(x)
x
fortify(out)
x <- spider$Girdled
out <- iNEXT(x, q=0, datatype="abundance")
out
print.iNEXT <- function(x){
site.n <- nrow(x$DataInfo)
order.n <- ifelse(site.n > 1,
paste(unique(x$iNextEst[[1]]$order), collapse = ", "),
paste(unique(x$iNextEst$order), collapse = ", "))
cat("Compare ", site.n, " assemblages with Hill number order q = ", order.n,".\n", sep="")
cat("$class: iNEXT\n")
cat("$DataInfo: basic data information\n")
cat("$iNextEst: showing diversity estimates along with related statistics for a series of rarefied and extrapolated samples.\n")
cat("$AsyEst: showing asymptotic diversity estimates along with related statistics.\n")
return(invisible())
}
out <- iNEXT(x, q=0, datatype="abundance")
out
out$iNextEst
out$DataInfo
library(iNEXT)
data(spider)
x <- iNEXT(spider)
cat(x$iNextEst)
cat(x$DataInfo)
(x$iNextEst)
y=x$iNextEst[[1]]
quantile(y$m)
quantile(y$m, type = 1)
y[y$m==m]
y[y$m==m,]
m <- quantile(y$m, type = 1)
y[y$m==m,]
y[y$m%in%m,]
lapply((x$iNextEst), function(y){
m <- quantile(y$m, type = 1)
y[y$m%in%m,]
}
)
length((x$iNextEst))
x <- iNEXT(spider$Girdled)
lapply((x$iNextEst), function(y){
m <- quantile(y$m, type = 1)
y[y$m%in%m,]
})
sapply((x$iNextEst), function(y){
m <- quantile(y$m, type = 1)
y[y$m%in%m,]
})
length(x$iNextEst)length()
length(x$iNextEst)
class((x$iNextEst))
y <- x$iNextEst
m <- quantile(y$m, type = 1)
y[y$m%in%m,]
cat("$iNextEst: diversity estimates along with related statistics for a series of rarefied and extrapolated samples.\n")
if(class(x$iNextEst)=="data.frame"){
y <- x$iNextEst
m <- quantile(y$m, type = 1)
y[y$m%in%m,]
}else{
lapply((x$iNextEst), function(y){
m <- quantile(y$m, type = 1)
y[y$m%in%m,]
})
}
cat("$iNextEst: diversity estimates along with related statistics for a series of rarefied and extrapolated samples.\n")
cat("$iNextEst: diversity estimates along with rarefied and extrapolated samples.\n")
cat("$iNextEst: diversity estimates with rarefied and extrapolated samples.\n")
print.iNEXT <- function(x){
site.n <- nrow(x$DataInfo)
order.n <- ifelse(site.n > 1,
paste(unique(x$iNextEst[[1]]$order), collapse = ", "),
paste(unique(x$iNextEst$order), collapse = ", "))
cat("Compare ", site.n, " assemblages with Hill number order q = ", order.n,".\n", sep="")
cat("$class: iNEXT\n")
cat("$DataInfo: basic data information\n")
cat(x$DataInfo)
cat("$iNextEst: diversity estimates with rarefied and extrapolated samples.\n")
cat("call iNEXT.objext$iNextEst. to show complete output.\n")
if(class(x$iNextEst)=="data.frame"){
y <- x$iNextEst
m <- quantile(y$m, type = 1)
y[y$m%in%m,]
}else{
lapply((x$iNextEst), function(y){
m <- quantile(y$m, type = 1)
y[y$m%in%m,]
})
}
cat("$AsyEst: asymptotic diversity estimates along with related statistics.\n")
cat(x$AsyEst)
return(invisible())
}
x
print.iNEXT <- function(x){
site.n <- nrow(x$DataInfo)
order.n <- ifelse(site.n > 1,
paste(unique(x$iNextEst[[1]]$order), collapse = ", "),
paste(unique(x$iNextEst$order), collapse = ", "))
cat("Compare ", site.n, " assemblages with Hill number order q = ", order.n,".\n", sep="")
cat("$class: iNEXT\n")
cat("$DataInfo: basic data information\n")
print(x$DataInfo)
cat("$iNextEst: diversity estimates with rarefied and extrapolated samples.\n")
cat("call iNEXT.objext$iNextEst. to show complete output.\n")
if(class(x$iNextEst)=="data.frame"){
y <- x$iNextEst
m <- quantile(y$m, type = 1)
y[y$m%in%m,]
}else{
lapply((x$iNextEst), function(y){
m <- quantile(y$m, type = 1)
y[y$m%in%m,]
})
}
cat("$AsyEst: asymptotic diversity estimates along with related statistics.\n")
print(x$AsyEst)
return(invisible())
}
x
source('~/github/iNEXT/R/plot.R')
x
source('~/github/iNEXT/R/plot.R')
source('~/github/iNEXT/R/plot.R')
x
source('~/github/iNEXT/R/plot.R')
x
out <- iNEXT(ant, q=0, datatype="incidence_freq")
data(ant)
out <- iNEXT(ant, q=0, datatype="incidence_freq")
out
x=out
lapply((x$iNextEst), function(y){
m <- quantile(y$m, type = 1)
res <- y[y$m%in%m,]
})
print(res)
source('~/github/iNEXT/R/plot.R')
out
lapply((x$iNextEst), function(y){
m <- quantile(y$m, type = 1)
y[y$m%in%m,]
})
source('~/github/iNEXT/R/plot.R')
out
library(iNEXT)
rm(plot.iNEXT
)
plot(x)
ggiNEXT(x)
library(datasets)
?co2
co2
head(co2)
